<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name = "viewport" content = "width=device-width, height=device-height, initial-scale=1">
    <style>
      * {
        margin: 0;
    padding: 0;
    border: 0;
      }

      html {
        height: 100%;
      }

        body {
          width: 100%;
          height: 100%;
          background-color: aqua;
          position: relative;
          overflow: hidden;
        }

        td {
        width: 30px;
        height: 30px;
        text-align: center;
        vertical-align: middle;
        border: 1px solid black;
        cursor: pointer;
      }
      .hidden {
        background-color: gray;
      }
      .mine {
        background-color: black;
        color: white;
      }

        /* #backgroundCanvas {
          position: absolute;
          left: 0px;
          top: 0px;
          right: 0px;
          bottom: 0px;
        }

        .bar {
          width: 95px;
          height: 100%;
          position: absolute;
          top: 0px;
          bottom: 0px;
          right: 60%;
          z-index: 100;
        }

        .topBarImg {
          position: absolute;
          width: 100%;
          height: 100%;
          object-fit: contain;
        }

        .topBar {
          width: 100%;
          height: 106px;
          z-index: 90;
          display: flex;
          flex-direction: row;
          justify-content: space-around;
          align-items: center;
        }

        .tab-button {
          z-index: 4;
          width:64px;
          height:64px;
        }

        .right {
          width: 60%;
          height: 100%;
          position: absolute;
          right: 0px;
          background-color: aqua;
          display:flex;
          flex-direction: column;
        }

        .table {
          width: 100%;
          flex-grow: 2;
          background-color: blueviolet;
        }

        .table1 {
          width: 70%;
          height: 100%;
          position: absolute;
          left: 0px;
          background-color: greenyellow;
          
          overflow-y: scroll;
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 10px;
          min-height: 0;
        }

        .table2 {
          font-size: 12px;
          width: 30%;
          height: 100%;
          position: absolute;
          right: 0px;
          display: flex;
          flex-direction: column;
          justify-content: space-around;
          align-items: center;
        }

        
        .topImgImg {
          position: absolute;
          object-fit: fill;
          top: 0;
          height: 100%;
          width: 100%;
          z-index: 2;
        }

        .upgrade {
          display: flex;
          font-family: 'gi-font';
          justify-content: center;
          align-items: center;
          width:90%;
          height: 10%;
          background-color: rgb(186, 22, 22);
          flex:none;
        } */
        
    </style>
    <title>nahidaQuest!</title>
</head>
<body>
  <div id="game">
    <canvas id="backgroundCanvas" style="background-color: yellow"></canvas>
    <table id="board">
      <!-- The game board will be dynamically generated here -->
    </table>
  </div>

    <script type="module">
      const ROWS = 9;
    const COLS = 9;
const MINES = 10;

// Create the game board
const board = [];
for (let r = 0; r < ROWS; r++) {
  const row = [];
  for (let c = 0; c < COLS; c++) {
    row.push({ mine: false, revealed: false });
  }
  board.push(row);
}

// Place the mines randomly
let minesPlaced = 0;
while (minesPlaced < MINES) {
  const row = Math.floor(Math.random() * ROWS);
  const col = Math.floor(Math.random() * COLS);
  if (!board[row][col].mine) {
    board[row][col].mine = true;
    minesPlaced++;
  }
}

// Get the number of mines adjacent to a cell
function countAdjacentMines(row, col) {
  let count = 0;
  for (let r = Math.max(0, row - 1); r <= Math.min(ROWS - 1, row + 1); r++) {
    for (let c = Math.max(0, col - 1); c <= Math.min(COLS - 1, col + 1); c++) {
      if (board[r][c].mine && (r !== row || c !== col)) {
        count++;
      }
    }
  }
  return count;
}

// Reveal a cell and its neighbors (recursively) if it has no adjacent mines
function revealCell(r, c) {
  if (r >= 0 && r < ROWS && c >= 0 && c < COLS && !board[r][c].revealed) {
    board[r][c].revealed = true;
    const tr = table.children[r];
    const td = tr.children[c];
    if (countAdjacentMines(r, c) === 0) {
      td.innerText = "-";
      for (let r2 = r - 1; r2 <= r + 1; r2++) {
        for (let c2 = c - 1; c2 <= c + 1; c2++) {
          revealCell(r2, c2);
        }
      }
    } else {
      td.innerText = countAdjacentMines(r, c);
    }
  }
}

let firstClick = true;
// Render the game state in a HTML table
const table = document.createElement("table");
for (let r = 0; r < ROWS; r++) {
  const tr = document.createElement("tr");
  for (let c = 0; c < COLS; c++) {
    const td = document.createElement("td");
    td.innerText = board[r][c].revealed
      ? countAdjacentMines(r, c) || "-"
      : "";
    td.addEventListener("contextmenu", function(event) {
      event.preventDefault();
      if (!board[r][c].revealed) {
        if (board[r][c].flagged) {
          td.innerText = "";
          board[r][c].flagged = false;
        } else {
          td.innerText = "F";
          td.style.backgroundImage = "url(./assets/mine-flag.webp)"
          board[r][c].flagged = true;
        }
      }
    });
    td.addEventListener("click", function() {
      if (firstClick) {
        while (board[r][c].mine) {
          initializeBoard();
        }
        firstClick = false;
      }
      if (board[r][c].mine) {
        td.innerText = "X";
        td.style.backgroundImage = "url(./assets/mine-wrong.webp)"
      } else {
        revealCell(r, c);
        td.style.backgroundImage = "url(./assets/mine-empty.webp)"
      }});
    tr.appendChild(td);
  }
  table.appendChild(tr);
}
document.body.appendChild(table);




    </script>


</body>
</html>