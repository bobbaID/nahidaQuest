<!doctype html> 
<html lang="en" > 
<head> 
    <meta charset="UTF-8" />
    <title>nahidaQuest!</title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/numeral.js/2.0.6/numeral.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <style type="text/css">
        button {
            border: 0px;
        }

        body {
            position: relative;
            font-family: 'gi-font';
            padding-top: 10px #000000;
        }

        *:hover {
            cursor: url(./assets/cursor.png), auto;   
        }
    </style>

</head>
<body id="bodyID">
    <p id="para">
        <div class="score-container">
            <span id="energy">0</span>
            <span id="score">0</span>              <!------------------------ CHANGE TO PARAGRAPH LATER -->
            <span id="dps">0</span>
            <span id="primogem">0</span>
        </div>
        
        <div class="flex-container-TAB" id="flex-container-TAB">
        </div>

        <div id="demo-container"></div>
    </p>

    <table>
        <table id="table1" class="uiTab" style="position: absolute; left: 10px; top:45px; width: 650px; height: 760px;">
            <tr></tr>
        </table>
        <div id="table2" class="uiTab flex-container-INVENTORY" style="position: absolute; top:40px;"></div>
        <div id="table3" class="uiTab flex-container-EXPEDITION" style="position: absolute; top:55px; left: 12px; width:950px;"></div>
        <div id="table4" class="uiTab wish-counter"></div>
        <table id="table5" class="uiTab flex-container-ACHIEVEMENT">
            <tr></tr>
        </table>
    </table>

<script type="module">
    var clickCount = 0;
    var clickFactor = 1;
    var dps = 0;
    var realScore = 0;

    var freeLevels = 0;
    var primogem = 0;
    var energy = 100000;

    var rowCount = 0;
    var itemCount = 0;

    var energyChance = 100000;
    var upperEnergyRate = 15;
    var lowerEnergyRate = 7;
    var clickDelay = 10;
    
    // RMB TO UPDATE CONSTANTS

    var upgradeDict = {
        0: {Name: "Nahida",      Row:-1,  "Level": 1, "Cost":20, Factor:1,        Purchased: -1,   Type: "Catalyst",   Ele: "Dendro"},
        1: {Name: "Traveller",   Row:-1,          Purchased: -1,   Type: "Sword",      Ele: ""},
        2: {Name: "Collei",      Row:-1,          Purchased: -1,   Type: "Bow",        Ele: "Dendro"},
        3: {Name: "Cyno",        Row:-1,          Purchased: -1,   Type: "Polearm",   Ele: "Electro"},
        4: {Name: "Candace",     Row:-1,          Purchased: -1,   Type: "Polearm",   Ele: "Hydro"},
        5: {Name: "Dori",        Row:-1,          Purchased: -1,  Type: "Claymore",   Ele: "Electro"},
        6: {Name: "Tighnari",    Row:-1,          Purchased: -1,   Type: "Bow",      Ele: "Dendro"},
        7: {Name: "Nilou",       Row:-1,          Purchased: -1,   Type: "Sword",     Ele: "Hydro"},
        8: {Name: "Layla",       Row:-1,          Purchased: -1,   Type: "Sword",     Ele: "Cryo"},
        9: {Name: "Faruzan",     Row:-1,          Purchased: -1,   Type: "Bow",       Ele: "Anemo"},
        10: {Name: "Dehya",      Row:-1,          Purchased: -1,   Type: "Claymore",   Ele: "Pyro"},
        11: {Name: "Alhaitham",  Row:-1,          Purchased: -1,   Type: "Sword",    Ele: "Dendro"},
        12: {Name: "Amber",      Row:-1,          Purchased: -1,   Type: "Bow",      Ele: "Pyro"},
        13: {Name: "Bennett",    Row:-1,          Purchased: -1,   Type: "Sword",      Ele: "Pyro"},
        14: {Name: "Noelle",     Row:-1,          Purchased: -1,   Type: "Claymore",      Ele: "Geo"},
        15: {Name: "Barbara",    Row:-1,          Purchased: -1,   Type: "Catalyst",      Ele: "Hydro"},
        16: {Name: "Lisa",       Row:-1,          Purchased: -1,   Type: "Catalyst",      Ele: "Electro"},
        17: {Name: "Kaeya",      Row:-1,          Purchased: -1,   Type: "Sword",      Ele: "Cryo"},
        18: {Name: "Diluc",      Row:-1,          Purchased: -1,   Type: "Claymore",      Ele: "Pyro"},
        19: {Name: "Diona",      Row:-1,            Purchased: -1,   Type: "Bow",      Ele: "Cryo"},
        20: {Name: "Fischl",     Row:-1,            Purchased: -1,   Type: "Bow",      Ele: "Electro"},
        21: {Name: "Mona",       Row:-1,            Purchased: -1,   Type: "Catalyst",      Ele: "Hydro"},
        22: {Name: "Rosaria",    Row:-1,            Purchased: -1,   Type: "Polearm",      Ele: "Cryo"},
        23: {Name: "Klee",       Row:-1,            Purchased: -1,   Type: "Catalyst",      Ele: "Pyro"},
        24: {Name: "Razor",      Row:-1,            Purchased: -1,   Type: "Claymore",      Ele: "Electro"},
        25: {Name: "Sucrose",    Row:-1,            Purchased: -1,   Type: "Catalyst",      Ele: "Anemo"},
        26: {Name: "Xiangling",  Row:-1,            Purchased: -1,   Type: "Polearm",      Ele: "Pyro"},
        27: {Name: "Xingqiu",    Row:-1,            Purchased: -1,   Type: "Sword",      Ele: "Hydro"},
        28: {Name: "Chongyun",   Row:-1,            Purchased: -1,   Type: "Claymore",      Ele: "Cryo"},
        29: {Name: "Xinyan",     Row:-1,            Purchased: -1,   Type: "Claymore",      Ele: "Pyro"},
        30: {Name: "Yun Jin",    Row:-1,            Purchased: -1,   Type: "Polearm",      Ele: "Geo"},
        31: {Name: "Beidou",     Row:-1,            Purchased: -1,   Type: "Claymore",      Ele: "Electro"},
        32: {Name: "Ningguang",  Row:-1,            Purchased: -1,   Type: "Catalyst",      Ele: "Geo"},
        33: {Name: "Ganyu",      Row:-1,            Purchased: -1,   Type: "Bow",      Ele: "Cryo"},
        34: {Name: "Keqing",     Row:-1,            Purchased: -1,   Type: "Sword",      Ele: "Electro"},
        35: {Name: "Yanfei",     Row:-1,            Purchased: -1,   Type: "Catalyst",      Ele: "Pyro"},
        36: {Name: "Kazuha",     Row:-1,            Purchased: -1,   Type: "Sword",      Ele: "Anemo"},
        37: {Name: "Thoma",      Row:-1,            Purchased: -1,   Type: "Polearm",      Ele: "Pyro"},
        38: {Name: "Yoimiya",    Row:-1,            Purchased: -1,   Type: "Bow",      Ele: "Pyro"},
        39: {Name: "Ayaka",      Row:-1,            Purchased: -1,   Type: "Sword",      Ele: "Cryo"},
        40: {Name: "Gorou",      Row:-1,            Purchased: -1,   Type: "Bow",      Ele: "Geo"},
        41: {Name: "Kokomi",     Row:-1,            Purchased: -1,   Type: "Catalyst",      Ele: "Hydro"},
        42: {Name: "Sayu",       Row:-1,            Purchased: -1,   Type: "Claymore",      Ele: "Anemo"},
        43: {Name: "Heizou",     Row:-1,            Purchased: -1,   Type: "Catalyst",      Ele: "Anemo"},
        44: {Name: "Shinobu",    Row:-1,            Purchased: -1,   Type: "Sword",      Ele: "Electro"},
        45: {Name: "Itto",       Row:-1,            Purchased: -1,   Type: "Claymore",      Ele: "Geo"},
        46: {Name: "Sara",       Row:-1,            Purchased: -1,   Type: "Bow",      Ele: "Electro"},
        47: {Name: "Venti",      Row:-1,           Purchased: -1,   Type: "Bow",   Ele: "Anemo"},
        48: {Name: "Zhongli",    Row:-1,           Purchased: -1,   Type: "Polearm",   Ele: "Geo"},
        49: {Name: "Raiden",     Row:-1,            Purchased: -1,   Type: "Polearm",   Ele: "Electro"},
// RMB TO UPDATE MAX CONSTANTS// RMB TO UPDATE MAX CONSTANTS// RMB TO UPDATE MAX CONSTANTS// RMB TO UPDATE MAX CONSTANTS// RMB TO UPDATE MAX CONSTANTS
        100: {Name: "Jean",        Row:-1,        Purchased: -10,   Type: "Sword",   Ele: "Anemo"},
        101: {Name: "Albedo",      Row:-1,        Purchased: -10,   Type: "Sword",   Ele: "Geo"},
        102: {Name: "Qiqi",        Row:-1,        Purchased: -10,   Type: "Sword",   Ele: "Cryo"},
        103: {Name: "Yelan",       Row:-1,        Purchased: -10,   Type: "Bow",   Ele: "Hydro"},
        104: {Name: "Shenhe",      Row:-1,        Purchased: -10,   Type: "Polearm",   Ele: "Cryo"},
        105: {Name: "Ayato",       Row:-1,        Purchased: -10,   Type: "Sword",   Ele: "Hydro"},
        106: {Name: "Yae Miko",    Row:-1,        Purchased: -10,   Type: "Catalyst",   Ele: "Electro"},
        107: {Name: "Eula",        Row:-1,        Purchased: -10,   Type: "Claymore",   Ele: "Cryo"},
        108: {Name: "Hu Tao",      Row:-1,        Purchased: -10,   Type: "Polearm",   Ele: "Pyro"},
        109: {Name: "Xiao",        Row:-1,        Purchased: -10,   Type: "Polearm",   Ele: "Anemo"},
        110: {Name: "Tartaglia",   Row:-1,        Purchased: -10,   Type: "Bow",   Ele: "Hydro"},
        111: {Name: "Scaramouche", Row:-1,        Purchased: -10,   Type: "Catalyst",   Ele: "Anemo"},
    }


    // RMB TO UPDATE MAX CONSTANTS
    var Inventory = {
        1001: {Name:"coolSteel",      Star:3,  Type:"Sword"},
        1002: {Name:"ferrous",        Star:3,  Type:"Claymore"},
        1003: {Name:"mappa",          Star:4,  Type:"Catalyst"},
        1004: {Name:"rust",           Star:4,  Type:"Bow"},
        1005: {Name:"silverSword",    Star:2,  Type:"Sword"},
        1006: {Name:"dullSword",      Star:1,  Type:"Sword"},
        1007: {Name:"skywardBlade",   Star:5,  Type:"Sword"},
        1008: {Name:"harbingerDawn",  Star:3,  Type:"Sword"},
        1009: {Name:"travelerHandySword",      Star:3,  Type:"Sword"},
        1010: {Name:"sacSword",          Star:3,  Type:"Sword"},
        1011: {Name:"lionsRoar",           Star:3,  Type:"Sword"},
        1012: {Name:"aquilaFavonia",           Star:5,  Type:"Sword"},
        
    // RMB TO UPDATE MAX CONSTANTS
    // RMB TO UPDATE MAX CONSTANTS
    // RMB TO UPDATE MAX CONSTANTS
    // RMB TO UPDATE MAX CONSTANTS
    // RMB TO UPDATE MAX CONSTANTS
        2001: {Name:"gladiator",      Star:4},
        2002: {Name:"deepwood",       Star:5},
        2003: {Name:"crimWitch",      Star:5},
    // RMB TO UPDATE MAX CONSTANTS
        3001: {Name:"masalaCheese",   Star:2,                     BuffTemp:10},
        3002: {Name:"jueyunchili",    Star:2,                     BuffTemp:10},

        4001: {Name:"wandererEXP",    Star:2,                     BuffLvl:3},
        4002: {Name:"adventureEXP",   Star:3,                     BuffLvl:5},
        4003: {Name:"heroEXP",        Star:4,                     BuffLvl:10},
    }

    var tooltip = {
    Nahida:{text:"A caged bird secluded within the confines of the Sanctuary of Surasthana who can only see the world in her dreams."},
    Traveller:{text:"The keeper is fading away; the creator has not yet come.But the world shall burn no more, for you shall ascend."},
    }

    const weaponBuffPercent = [0, 10, 100, 1000, 10000, 100000];
    const artifactBuffPercent = [0, 1.02, 1.05, 1.10, 1.20, 1.35];

    
    const WEAPONMAX = 1009;
    const ARTIFACTMAX = 2104;
    const FOODMAX = 3003;
    const XPMAX = 4004;

    const NONWISHHEROMAX = 49
    const WISHHEROMIN = 100;
    const WISHHEROMAX = 112;
    const WISHCOST = 10;
    const STARTINGWISHFACTOR = 50;

    var wishMultiplier = 0;
    var wishCounter = WISHHEROMAX - WISHHEROMIN;

    const ADVENTURECOSTS = [0, 100, 200, 300, 400, 500];
    const ADVENTUREFAILURE = [0, 0, 5, 10, 20, 30];

    var demoContainer = document.getElementById("demo-container");
    var score = document.getElementById("score");
    var energyDisplay = document.getElementById("energy");
    var dpsDisplay = document.getElementById("dps");
    var primogemDisplay = document.getElementById("primogem");

    var table1 = document.getElementById("table1");
    var table2 = document.getElementById("table2");
    var table3 = document.getElementById("table3");
    var table4 = document.getElementById("table4");
    var table5 = document.getElementById("table5");
    
    var TABS = [table1,table2, table3, table4, table5];
    

    // MAIN BODY VARIABLES
    var mainBody = document.getElementById("bodyID");
    let table6 = document.createElement("table");
    mainBody.appendChild(table6);
    table6.classList += "table6";
    
    
    // MAIN BODY GUI
    var para1 = document.getElementById("para")
    var leftImg =  document.createElement("img");
    leftImg.src = "./assets/bg-1.png";
    leftImg.style = "position: absolute; left:-30px; top: -17px; width: 630px; height: 870px;";
    para1.appendChild(leftImg);

    var barImg =  document.createElement("img");
    barImg.src = "./assets/bar.jpg";
    barImg.style = "position: absolute; left: 600px; top: -16px; width: 95px; height: 870px;";
    para1.appendChild(barImg);

    var topImg =  document.createElement("img");
    topImg.src = "./assets/top-bar.png";
    topImg.style = "position: absolute; left: 695px; top: -16px; width: 969px; height: 106px;";
    para1.appendChild(topImg);

    var mainImg =  document.createElement("img");
    mainImg.src = "./assets/main-bar.png";
    mainImg.style = "position: absolute; left: 695px; top: 90px; width: 970px; height: 765px;";
    para1.appendChild(mainImg);

    var expedDiv = document.createElement("div");
    expedDiv.classList = "tooltipEXPED";
    expedDiv.id = "expedDivID";

    mainImg.src = "./assets/main-bar.png";
    mainImg.style = "position: absolute; left: 695px; top: 90px; width: 970px; height: 765px;";
    para1.appendChild(mainImg);

    // TOOLTIPS FOR EXPEDITION
    var expedTable = document.createElement("table");
    expedTable.classList = "tooltipTABLEEXPED";

    let expedRow = expedTable.insertRow(0);
    expedRow.style.height = "110px";
    var expedCell2 = expedRow.insertCell(0);
    expedCell2.classList += "exped-cell-two"

    let expedRow2 = expedTable.insertRow(0);
    expedRow2.style.height = "80px";
    var expedCell1 = expedRow2.insertCell(0);
    expedCell1.classList += "exped-cell-one"

    expedDiv.appendChild(expedTable);
    para1.appendChild(expedDiv);

    var expedContainer = document.getElementById("table3");
    expedDiv.style.display = "none";

    // CREATING EXPEDITION UI
    createExpedition()
    function createExpedition() {
        for (let i = 1; i < 6; i++) {
            let expedButton = document.createElement("button");
            
            if (i > 2){
                var backgroundImg = "url(./assets/exped6.png)";
            } else {
                var backgroundImg = "url(./assets/exped" + i + ".png)";
            }

            expedButton.id = "exped-" + i;
            expedButton.addEventListener("click", function() {adventure(i)});
            expedButton.addEventListener("mouseover", function() {expedInfo(this.id)});
            expedButton.addEventListener("mouseout", function() {expedInfo(7)});
            expedButton.style.background = backgroundImg;
            expedButton.style['background-repeat'] = "no-repeat";
            expedButton.style['background-size'] = "93%"
            expedButton.classList += "expedition";
            
            expedContainer.appendChild(expedButton);
        }
    }

    var expeditionDict = {
        1:{Text:"Explore Teyvat"                  ,Lore:"The best way to understand the world is to explore all that is around you, leaving no stone unturned. Solving the enigmas of old, helping hapless travelers, and following the trails of long-lost treasure will all become invaluable knowledge and experience.", Locked: 0},
        2:{Text:"Visit the Adventurers' Guild"    ,Lore:"They boldly venture up to the stars, down to the abyss, or so their motto would have you believe. In truth, they take on jobs ranging from finding kittens to exploring domains.",Locked: 0},
        3:{Text:"Challenge Domains"               ,Lore:"Domains hide precious treasures. Be sure to explore the domains scattered all over the world to find the treasures hidden within.", Locked: 1},
        4:{Text:"Hunt Boss Enemies"               ,Lore:"Bosses are strong Enemies that are scattered across the world. They are much stronger than elite enemies, but also provide luxurious rewards for defeating them.", Locked: 1},
        5:{Text:"Abyss Diving"                    ,Lore:"Monsters and humans alike flock to the tower in search of the secrets and treasures it contains. Challenge different floors of the tower and defeat the enemies within to win Abyssal Stars...with the help of an ally.", Locked: 1},
        6:{Text:"Locked"                             ,Lore:"Perhaps this path will open after some time..."            ,Locked: 0},
        7:{Text:""                             ,Lore:""            ,Locked: 0},
    }

    function expedInfo(butId){
        let i = 0;
        if (butId == 7) {
            i = 7;
        } else {
            i = butId.split("-")[1];
        }

        if (expeditionDict[i]["Locked"] == 0 || i == 7) {
            expedCell1.innerHTML = expeditionDict[i]["Text"];
            expedCell2.innerHTML = expeditionDict[i]["Lore"];
        } else {
            expedCell1.innerHTML = expeditionDict[6]["Text"];
            expedCell2.innerHTML = expeditionDict[6]["Lore"];
        }
    }

    function unlockExpedition(i) {
        let expedID = "exped-" + i;
        let unlockButton = document.getElementById(expedID);
        let backgroundImage = "url(./assets/exped" + i + ".png)";

        expeditionDict[i].Locked = 0;
        unlockButton.style.background = backgroundImage;
        unlockButton.style["background-repeat"] = "no-repeat";
        unlockButton.style["background-size"]= "93%";
    }

    unlockExpedition(4)
    
    // TOOLTIPS FOR HEROES/ITEMS
    var tooltipTop = (table6.insertRow(0)).insertCell(0);
    tooltipTop.align = "center"
    tooltipTop.style = "height:300px"

    var toolImg = document.createElement("img");
    toolImg.src = "./assets/tooltips/empty.png";
    toolImg.style ="width:250px;height:250px;";
    
    // TOOLTIP UI
    tooltipTop.appendChild(toolImg);
    var tooltipText = (table6.insertRow(1)).insertCell(0);

    function changeTooltip(name) {
        let tooltipContent = tooltip[name].text;
        tooltipText.innerText = tooltipContent;
        toolImg.src = "./assets/tooltips/"+name+".png";
    }

    function clearTooltip() {
        tooltipText.innerText = "";
        toolImg.src = "./assets/tooltips/empty.png";
    }

    var achievementTypeRawScore = [10,1e3,1e4,1e6,1e8,1e9,1e11,1e12,1e14,1e15,1e17,1e18,1e20,1e21,1e23,1e24];
    var achievementTypeRawDPS =   [1,10,100,10000,1e5,1e6,1e8,1e9,1e11,1e12,1e14,1e15,1e17,1e18,1e20,1e21];
    var achievementTypeRawCollection = "";
    var achievementTypeRawClicking = "";
    var achievementList = {
        1: {Name:"Nut Collector", Description:"Collect 10 nuts"},
        2: {Name:"Nut Fan", Description:"Collect 1000 nuts"},
        3: {Name:"Nut Gatherer", Description:"Collect 10,000 nuts"},
        4: {Name:"Nut Accumulator", Description:"Collect 1 million nuts"},
        5: {Name:"Nut Hobbyist", Description:"Collect 100 million nuts"},
        6: {Name:"Nut Addict", Description:"Collect 1 billion nuts"},
        7: {Name:"Nut Fancier", Description:"Collect 100 billion nuts"},
        8: {Name:"Nut Lord", Description:"Collect 1 trillion nuts"},
        9: {Name:"Nut Authority", Description:"Collect 100 trillion nuts"},
        10: {Name:"Nut Connoisseur", Description:"Collect 1 quadrillion nuts"},
        11: {Name:"Nut Devotee", Description:"Collect 100 quadrillion nuts"},
        12: {Name:"Nut Aficionado", Description:"Collect 1 quintillion nuts"},
        13: {Name:"Nut Pundit", Description:"Collect 100 quintillion nuts"},
        14: {Name:"Nut Antiquarian", Description:"Collect 1 sextillion nuts"},
        15: {Name:"Nut Savant", Description:"Collect 100 sextillion nuts"},
        16: {Name:"Nut Archon", Description:"Collect 1 septillion nuts"},
        17: {Name:"", Description:"Reach 1 NpS"},
        18: {Name:"", Description:"Reach 10 NpS"},
        19: {Name:"", Description:"Reach 100 NpS"},
        20: {Name:"", Description:"Reach 10,000 NpS"},
        21: {Name:"", Description:"Reach 100,000 NpS"},
        22: {Name:"", Description:"Reach 1 million NpS"},
        23: {Name:"", Description:"Reach 100 million NpS"},
        24: {Name:"", Description:"Reach 1 billion NpS"},
        25: {Name:"", Description:"Reach 100 billion NpS"},
        26: {Name:"", Description:"Reach 1 trillion NpS"},
        27: {Name:"", Description:"Reach 100 trillion NpS"},
        28: {Name:"", Description:"Reach 1 quadrillion NpS"},
        29: {Name:"", Description:"Reach 100 quadrillion NpS"},
        30: {Name:"", Description:"Reach 1 quintillion NpS"},
        31: {Name:"", Description:"Reach 100 quintillion NpS"},
        32: {Name:"", Description:"Reach 1 sextillion NpS"},
        33: {Name:"", Description:"C"},
        34: {Name:"", Description:"C"},
        35: {Name:"", Description:"C"},
        36: {Name:"", Description:"C"},
        37: {Name:"", Description:""},
        38: {Name:"", Description:""},
        39: {Name:"", Description:""},
        40: {Name:"", Description:""},
        41: {Name:"", Description:""},
        42: {Name:"", Description:""},
        43: {Name:"", Description:""},
        44: {Name:"", Description:""},
        45: {Name:"", Description:""},
        46: {Name:"", Description:""},
        47: {Name:"", Description:""},
        48: {Name:"", Description:""},
        49: {Name:"", Description:""},
        50: {Name:"", Description:""},
    }

    var scoreAchievementScore = 1;
    var scoreAchievementDps = 17;

    // ACHIEVEMENTS
    function createAchievement(idNum) {
        var itemUniqueID = "item-" + idNum + "-" + itemCount;
        table5.innerHTML += 0;
    }


    function popAchievement(achievement) {
        var oldAchievement = document.getElementById("tempAchievement");
        if (oldAchievement != null) {
            mainBody.removeChild(oldAchievement);
        }

        if (achievement == "score") {
            var achievementText = achievementList[scoreAchievementScore].Name;
            var achievementDesc = achievementList[scoreAchievementScore].Description;
            scoreAchievementScore++;
        } else if (achievement == "dps") {
            var achievementText = achievementList[scoreAchievementDps].Name;
            var achievementDesc = achievementList[scoreAchievementDps].Description;
            scoreAchievementDps++;
        }

        var achievementPopUp = document.createElement("p");
        let achievementH1 = document.createElement("h2");
        achievementH1.innerText = achievementText;
        achievementH1.classList += "achieveH1"
        let achievementH2 = document.createElement("h3");
        achievementH2.innerText = achievementDesc;
        achievementH2.classList += "achieveH2"

        achievementPopUp.appendChild(achievementH1);
        achievementPopUp.appendChild(achievementH2);
        achievementPopUp.id = "tempAchievement"

        achievementPopUp.onclick = achievementPopUp.remove;
        achievementPopUp.classList += "achieve"
        mainBody.appendChild(achievementPopUp); 
        
        var achievementStored = document.createElement("p");
        let achievementStoredH1 = document.createElement("h2");
        achievementStoredH1.innerText = achievementText;
        achievementStoredH1.classList += "achieveStoredH1"
        let achievementStoredH2 = document.createElement("h3");              // MAKE THE BACKGROUND IMAGE SUMERU TALENT
        achievementStoredH2.innerText = achievementDesc;                     // HAVE THE MIDDLE PART INFINITELY EXTEND
        achievementStoredH2.classList += "achieveStoredH2"

        achievementStored.appendChild(achievementStoredH1);
        achievementStored.appendChild(achievementStoredH2);
        achievementStored.classList += "achieve-stored"
        table5.appendChild(achievementStored); 
    }

    function checkAchievement() {
        if (realScore >= achievementTypeRawScore[0]) {
            popAchievement("score");
            achievementTypeRawScore.shift();
        } else if (dps >= achievementTypeRawDPS[0]) {
            popAchievement("dps");
            achievementTypeRawDPS.shift();
        }
    }

    // ALL TIME-EVENTS SYNC TO THIS FUNCTION (TIME REFRESH SET TO 0.5 SECONDS)
    var timer = setInterval(timerEvents,500);

    function timerEvents() {
        checkAchievement()
        realScore += 0.5 * dps;
        refresh();
        addNewRow();
    } 

   

    // INITIAL LOADING
    generateHeroPrices();
    tabChange(4)
    refresh();

    realScore++;
    addNewRow();
    realScore--;

    // TAB UI
    createTabs();
    function createTabs() {
        let tabFlex = document.getElementById("flex-container-TAB");
        for (let i = 0; i < TABS.length; i++){
            let tabButton = document.createElement("button");
            tabButton.classList += "tab-button";
            tabButton.style.background = "url(./assets/tab"+ (i + 1) +".png)";
            tabButton.addEventListener('click', function(){
                tabChange(i + 1);
            })
            tabFlex.appendChild(tabButton);
        }
    }

    // CHANGE TABS
    function tabChange(x) {

        for (let i = 0; i < TABS.length; i++){
            TABS[i].style.display = "none";
        }
        TABS[x-1].style.display = "flex";

         if (x-1 == 0 || x-1 == 1) {
            table6.style.display = "block";
         } else {
            table6.style.display = "none"; 
         }

         if (x-1 == 2) {
            expedDiv.style.display = "block";
         } else {
            expedDiv.style.display = "none";
         }

    }

    // BIG BUTTON FUNCTIONS
    demoContainer.innerHTML += "<span id='demo'></span>";

    demo.onclick = function() {
        clickCount += 1;
        realScore += 1 * clickFactor;
        energyRoll();
        refresh();
    }

    demo.onmousedown = function() {
        demo.style.width = "92%";
        demo.style.height = "92%";
        demo.style["margin-top"] = '4%';
        demo.style["margin-left"] = '4%';
    }

    function mouseOver() {
        demo.style.width = "98%";
        demo.style.height = "98%";
        demo.style["margin-top"] = '1%';
        demo.style["margin-left"] = '1%';
    }

    demo.onmouseover = function () {
        mouseOver();
    };
    
    demo.onmouseup = function () {
        mouseOver()
    };

    demo.onmouseout = function() {
        demo.style.width = "95%";
        demo.style.height = "95%";
        demo.style["margin-top"] = '2.5%';
        demo.style["margin-left"] = '2.5%';
    }

   // RANDOM NUMBER GENERATOR
    function randomInteger(min, max) {
        return Math.floor(Math.random() * (max - min) ) + min;
    }

    // ROLL FOR ENERGY
    function energyRoll() {
        let randInt = Math.floor(Math.random() * 1000);
        clickDelay--;

        if (clickDelay < 1){
            if (randInt < energyChance){
                energy += randomInteger(lowerEnergyRate, upperEnergyRate);
                clickDelay = 10;
            }
        }
    }

    // GENERATE BASE ATK AND COSTS OF NON-WISH HEROES
    function generateHeroPrices() {
         for (let i = 1; i < NONWISHHEROMAX + 1; i++) {
            var initBaseCost = 50
            var multiplierBaseCost = 2.5
            let baseCost = Math.round(initBaseCost * (multiplierBaseCost ** (i-1)));
            let baseLevel = Math.round(0.75 * baseCost);
            upgradeDict[i]["Cost"] = Number(baseCost.toPrecision(3));
            upgradeDict[i]["Level"] = baseLevel;
            
            var initATKCost = 1
            var multiplierATKCost = 2.5
            let baseATK = Math.round(initATKCost * (multiplierATKCost ** (i-1)));
            upgradeDict[i]["Factor"] = Number(baseATK.toPrecision(3));
        }
    }

    function abbrNum(number) {
        let decPlaces = Math.pow(10, 2);
        var abbrev = [""," Million"," Billion"," Trillion"," Quadrillion"," Quintillion"," Sextillion"," Septillion"];

        if (number > 1e6) {
            for (var i = abbrev.length - 1; i >= 0; i--) {
                var size = Math.pow(10, (i + 1) * 3);
                if (size <= number) {
                    number = Math.round((number * decPlaces) / size) / decPlaces
                    if (number == 1000 && i < abbrev.length - 1) {
                            number = 1;
                            i++;
                        }
                    number += abbrev[i];
                    break;
                }
            }
            return number;
        } else {
            number = Math.round(number);
            return number;
        }
    }

    // SPAWN NEW HEROES IN LIST
    function addNewRow() {
        for (let i = 0; i < WISHHEROMAX; i++) {
            if (i < WISHHEROMIN && i > NONWISHHEROMAX) continue;
            if (realScore >= upgradeDict[i]["Level"] && upgradeDict[i].Purchased == -1){
                let newRow = table1.insertRow(-1);
                let newCell = newRow.insertCell(0);

                upgradeDict[i].Row = rowCount;
                upgradeDict[i].Purchased = 0;
                
                if (upgradeDict[i]["Level"] == 0) {
                    var heroText = "Summon " + upgradeDict[i].Name + " for help. (" + abbrNum(upgradeDict[i]["Cost"]) + ")";
                } else if (i == 0) {
                    var heroText = "Level Up Nahida (" + abbrNum(upgradeDict[i]["Cost"]) + ")";
                } else {
                    var heroText = "Call for " + upgradeDict[i].Name + "'s help... (" + abbrNum(upgradeDict[i]["Cost"]) + ")";
                }
                
                let heroButtonContainer = document.createElement("button");
                let toolName = upgradeDict[i].Name;
                let heroID = "but-" + rowCount;

                heroButtonContainer.id = heroID;
                heroButtonContainer.innerText = heroText;
                heroButtonContainer.style.background = "url(./assets/button-3.png)";
                heroButtonContainer.classList += "upgrade hero-glow";
                
                heroButtonContainer.addEventListener("mouseover", function() {changeTooltip(toolName)});
                heroButtonContainer.addEventListener("mouseout", function() {clearTooltip()});
                heroButtonContainer.addEventListener('click', function() {upgrade(heroID)});

                newCell.appendChild(heroButtonContainer);
                rowCount++;
            }
        }
    }
    
    // UPGRADE HEROES
    function upgrade(clicked_id) {
        var butIdArray = clicked_id.split("-")[1];
        for (let i = 0; i < WISHHEROMAX; i++) {
            if (i < WISHHEROMIN && i > NONWISHHEROMAX) continue;
            if (upgradeDict[i].Row == butIdArray) {
                let freePass = false;
                if (freeLevels > 0){
                    freePass = true;
                }

                console.log(realScore)
                console.log(upgradeDict[i]["Cost"])


                if (realScore >= upgradeDict[i]["Cost"]) {
                    if (freePass == true) {
                        realScore += upgradeDict[i]["Cost"];
                        freeLevels--;
                    }

                    realScore -= upgradeDict[i]["Cost"];
                    if (i == 0) {
                        clickFactor += upgradeDict[i]["Factor"];
                        var nextPrice =  Math.round(upgradeDict[i]["Cost"] * (1.3));
                        upgradeDict[i]["Cost"] = nextPrice;
                    } else {
                        dps += upgradeDict[i]["Factor"];
                        var nextPrice =  Math.round(upgradeDict[i]["Cost"] * (1.15));
                        upgradeDict[i]["Cost"] = nextPrice;
                    }
      
                    upgradeDict[i].Purchased += 1;
                    refresh(clicked_id, nextPrice, i);
                }
            }
        } 
    }

    // ADD TO INVENTORY 
    function inventoryAdd(idNum) {
        itemCount++;
        var itemUniqueID = idNum + "." + itemCount;
        let buttonInv = document.createElement("button");

        buttonInv.id = itemUniqueID;
        buttonInv.addEventListener('click', function(){
            itemUse(itemUniqueID);
        });

        buttonInv.classList += "inventoryButton";
        buttonInv.style.background = "url(./assets/inventory/" + Inventory[idNum].Name + ".jpg)";
        buttonInv.style["background-repeat"] = "no-repeat";
        buttonInv.style["background-size"] = "128px 144px";
        table2.appendChild(buttonInv);
    }

    function sortList() {
        var list, i, switching, b, shouldSwitch;
        list = document.getElementById("table2");
        switching = true;

        while (switching) {
            switching = false;
            b = list.getElementsByTagName("button");
            for (i = 0; i < (b.length - 1); i++) {
                shouldSwitch = false;
                if (b[i].id > b[i + 1].id) {
                    shouldSwitch = true;
                    break;
                }
            }
            
            if (shouldSwitch) {
            b[i].parentNode.insertBefore(b[i + 1], b[i]);
            switching = true;
            }
        }
    }

    // INVENTORY UI
    function itemUse(itemUniqueId) {
        let item = document.getElementById(itemUniqueId);
        let itemID = itemUniqueId.split(".")[0];
        if (itemID >= 1001 && itemID < WEAPONMAX){
            for (let i = 0; i < Object.keys(upgradeDict).length; i++) {
                if (i < WISHHEROMIN && i > NONWISHHEROMAX && i != 1 && Inventory[i] == undefined) continue;
                if (upgradeDict[i].Purchased > 0){
                    if (upgradeDict[i].Type == Inventory[itemID].Type){
                        upgradeDict[i]["Factor"] += weaponBuffPercent[Inventory[itemID].Star];
                        refresh("hero", i);
                    }
                }
            }
        } else if (itemID >= 2001 && itemID < ARTIFACTMAX){
            for (let i = 0; i < Object.keys(upgradeDict).length; i++) {
                if (i < WISHHEROMIN && i > NONWISHHEROMAX && i != 1 && Inventory[i] == undefined) continue;
                if (upgradeDict[i].Purchased > 0){
                    upgradeDict[i]["Factor"] *= artifactBuffPercent[Inventory[itemID].Star];
                    upgradeDict[i]["Factor"] = Math.round(upgradeDict[i]["Factor"]);
                    refresh("hero", i);
                }
            }
        }  else if (itemID >= 4001 && itemID <  XPMAX){
            freeLevels += Inventory[itemID].BuffLvl;
            refresh();
        }
        item.remove();
    }

    // EXPEDITION MECHANICS
    // RMB THERES A CHANCE OF FAILURE, IT IS NOT A BUG IF NOTHING HAPPENS
    function adventure(type) {
        console.log(expeditionDict[type].Locked)
        if (expeditionDict[type].Locked == '1'){
            alert("ITS LOCKED CANT YOU SEE!!!!!!!")
            return                                //// <------------------------ ADD THE POPUP FOR LOCKED
        } else {                                                     
            if (energy >= ADVENTURECOSTS[type]){
                energy -= ADVENTURECOSTS[type];
                refresh();

                let randInt = randomInteger(0, 99);
                if (randInt < ADVENTUREFAILURE[type]){
                    return;
                } else {
                    if (type == 1){
                    inventoryDraw("artifact", 1, 4);
                    inventoryDraw("weapon", 1, 1);
                    inventoryDraw("xp", 2, 2);
                    inventoryDraw("food", 1, 3);
                    }
                    if (type == 2){
                        inventoryDraw("xp", 2, 2);
                        inventoryDraw("food", 2, 3);
                        inventoryDraw("artifact", 2, 4);
                        inventoryDraw("weapon", 1, 2);
                    }
                    if (type == 3){
                        inventoryDraw("xp", 2, 3);
                        inventoryDraw("artifact", 3, 4);
                        inventoryDraw("food", 2, 4);
                        inventoryDraw("weapon", 2, 3);
                    }
                    if (type == 4){
                        inventoryDraw("weapon", 3, 4);
                        inventoryDraw("artifact", 3, 4);
                        inventoryDraw("xp", 3, 4);
                        inventoryDraw("food", 2, 4);
                    }
                    if (type == 5){
                        inventoryDraw("artifact", 4, 5);
                        inventoryDraw("weapon", 4, 5);
                        inventoryDraw("food", 2, 5);
                        inventoryDraw("xp", 4, 4);
                    }
                    sortList();
                }
            }  
        }   
    }

    // DRAWS FOR RANDOM INVENTORY LOOT 
    function inventoryDraw(itemType, min, max){
        var upperInventoryType = {"weapon": WEAPONMAX, "artifact": ARTIFACTMAX, "food": FOODMAX, "xp": XPMAX};
        var lowerInventoryType = {"weapon": 1001, "artifact": 2001, "food": 3001, "xp": 4001};
        let temp = 0;
        while (true){
            temp = randomInteger(lowerInventoryType[itemType], upperInventoryType[itemType])
            if (Inventory[temp] == undefined) {continue}
            if (Inventory[temp].Star >= min && Inventory[temp].Star < (max + 1)) {
                inventoryAdd(temp);
                break;
            } else {
                continue;
            }
        }
    }

    drawWish()

    // DRAWS FOR SPECIAL HEROS
    function drawWish() {
        let wishButton = document.createElement("button");
        wishButton.classList += "wish-button";
        wishButton.innerText = "Write for help"
        wishButton.addEventListener("click",function() {
            let mailImage = document.getElementById("mailImage")
            mailImage.src = "./assets/closed.png"
        });
        table4.appendChild(wishButton);

        let mailImage = document.createElement("img");
        mailImage.src = "./assets/open.png";
        mailImage.id = "mailImage"
        mailImage.classList += "wish-mail";
        table4.appendChild(mailImage);
    }


    function wish() {
        if (energy > WISHCOST) {
            energy -= WISHCOST;
            refresh();
            
            while (wishCounter) {
                let i = randomInteger(WISHHEROMIN, WISHHEROMAX)
                if (upgradeDict[i].Purchased >= -1) {
                    continue;
                } else {
                    upgradeDict[i].Purchased = -1;
                    upgradeDict[i]["Factor"] = Math.round(dps * (STARTINGWISHFACTOR + wishMultiplier)/30);
                    upgradeDict[i]["Cost"] = Math.round(dps * (20));

                    wishMultiplier += 5;
                    wishCounter--;
                    break;
                }
            }
        }
    }

    // REFRESH SCORES & ENERGY
    function refresh() {
        let formatScore = abbrNum(realScore);
        score.innerHTML = "Score: " + formatScore;

        let formatDps = abbrNum(dps);
        dpsDisplay.innerHTML = formatDps + " per second" ;

        energyDisplay.innerHTML = "Energy: " + energy;
        primogemDisplay.innerHTML = "Primogem: " + primogem;
        
        if (arguments[0] != undefined){
            if (arguments[0].includes("but-")){
                if (arguments[2] == 0) {
                    var formatCost = abbrNum(arguments[1]);
                } else {
                    var formatCost = abbrNum(arguments[1]);
                }

                var formatATK = abbrNum(upgradeDict[arguments[2]]["Factor"]);
                var heroText =  upgradeDict[arguments[2]].Name + ": " + formatCost + ", ATK: " + formatATK;
                let upgradedHeroButton = document.getElementById(arguments[0])
                upgradedHeroButton.innerText = heroText;
                upgradedHeroButton.style = "background:url(./assets/nahida.webp);  background-size: 90%; background-position: 25% center; background-repeat: no-repeat;";
                
            }
        } else if (arguments[0] == "hero"){
            let formatATK = abbrNum(upgradeDict[arguments[1]]["Factor"]);
            let formatCost = abbrNum(arguments[1]);
            var heroText =  upgradeDict[arguments[1]].Name + ": " + formatCost + ", ATK: " + formatATK;
            let id="but-" + arguments[1].rowCount + "";
            document.getElementById(id).innerText = heroText;
        }
    }
    

</script>
</body>
</html>
